# ëª©ì°¨

1. [IoC ì»¨í…Œì´ë„ˆ](#1-ioc-ì»¨í…Œì´ë„ˆ-)
<br /></t>
   1.1 [ApplicationContext](#1-1-applicationcontext-)
<br /></t>
   1.2 [Autowired](#1-2-autowired-)
<br /></t>
   1.3 [ComponentScan](#1-3-componentscan-)
<br /></t>
   1.4 [Bean ìŠ¤ì½”í”„](#1-4-bean-ìŠ¤ì½”í”„-)
<br /></t>
   1.5 [Environment](#1-5-environment-)
2. ë¦¬ì†ŒìŠ¤
3. Validation
4. ë°ì´í„° ë°”ì¸ë”©
5. SpEL
6. ìŠ¤í”„ë§ AOP
7. Null-Safety





<br /><br />

--------------------------------------------------------------------------

# 1. IoC ì»¨í…Œì´ë„ˆ [ğŸ‘†](#ëª©ì°¨)

## ì •ì˜

### 1) IoC 

 : ì–´ë–¤ ê°ì²´ê°€ ì‚¬ìš©í•˜ëŠ” ì˜ì¡´ ê°ì²´ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, ì£¼ì… ë°›ì•„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.

ì‰½ê²Œ ë§í•˜ë©´,

```java
private BookRepository bookRepository;
```

ì´ë ‡ê²Œë§Œ ì„ ì–¸í•˜ë©´ nullì¼í…ë°, ìŠ¤í”„ë§ì´ `bookRepository` ì— ëŒ€í•œ ì •ë³´ë¥¼ ì£¼ì…ì„ í•´ì¤˜ì„œ ë°”ë¡œ ì‚¬ìš©ì„ í•  ìˆ˜ ìˆë‹¤.



<br />

### 2) IoC ì»¨í…Œì´ë„ˆ 

 : Beanë“¤ì„ ê°€ì§€ê³  IoC ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì»¨í…Œì´ë„ˆì´ë‹¤.

ex)

- BeanFactory : IoCì»¨í…Œì´ë„ˆ ìµœìƒìœ„ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.
- ApplicationContext : BeanFactoryë¥¼ ìƒì†ë°›ì€ IoCì»¨í…Œì´ë„ˆë¡œ, ê°€ì¥ ë§ì´ ì‚¬ìš©í•œë‹¤.



<br />

### 3) Bean

 : **IoC ì»¨í…Œì´ë„ˆì— ì˜í•´ ê´€ë¦¬ë˜ëŠ” ê°ì²´**ì´ë‹¤.

#### ì¥ì 

1. IoCì»¨í…Œì´ë„ˆì— ì˜í•´ **ì˜ì¡´ì„± ê´€ë¦¬**ê°€ ëœë‹¤.

2. IoCì»¨í…Œì´ë„ˆì— ë“±ë¡ëœ Beanì€ ê¸°ë³¸ì ìœ¼ë¡œ **ì‹±ê¸€í†¤**ìœ¼ë¡œ ë“±ë¡ë˜ì–´ ì‹±ê¸€í†¤ìœ¼ë¡œ ì‚¬ìš©í•˜ë ¤ê³  í•  ë•Œ, í¸í•˜ë‹¤.

   cf) ìŠ¤ì½”í”„

   - ì‹±ê¸€í†¤ : í•˜ë‚˜ë§Œ ë§Œë“¤ì–´ì„œ ì „ì²´ì— ì‚¬ìš©í•˜ëŠ”ê²ƒ
   - í”„ë¡œí† íƒ€ì… : ë§¤ë²ˆ ë‹¤ë¥¸ ê°ì²´

3. **ë¼ì´í”„ ì‚¬ì´í´ ì¸í„°í˜ì´ìŠ¤** ë¡œ ë¶€ê°€ì ì¸ ì‘ì—…ì„ í•  ìˆ˜ ìˆë‹¤.

   (Beanì— ë“±ë¡ë˜ë©´ì„œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œë“¤ì„ ì´ìš©í•˜ëŠ” ê²½ìš°ë¥¼ ë§í•œë‹¤.)



<br /><br />

--------------------------------------------------------------------------

# 1-1. ApplicationContext [ğŸ‘†](#ëª©ì°¨)

### 1) (ê³ ì „ì ì¸) Bean ë“±ë¡ ë°©ë²•

: ìŠ¤í”„ë§ IoC ì»¨í…Œì´ë„ˆëŠ” ë¹ˆì„¤ì •(xml) íŒŒì¼ì´ ìˆì–´ì•¼í•œë‹¤. ê°€ë ¹, `BookService` ê°€ `BookRepository` ë¥¼ ì£¼ì…ë°›ëŠ”ë‹¤ê³  í•´ë³´ì.

```java
public class BookService{
   BookRepository bookRepository;

   public void setBookRepository(BookRepository bookRepository){
      this.bookRepository = bookRepository;
   }
}
```

ì´ë¥¼ ìœ„í•´ì„œëŠ”, ë‹¤ìŒê³¼ ê°™ì´ ì¼ì¼ì´ Beanìœ¼ë¡œ ë“±ë¡ì„ í•´ì¤˜ì•¼ í–ˆë‹¤.

**application.xml**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

  	<!-- ì—¬ê¸°ë¶€í„° -->
    <bean id="bookRepository"
        class="com.example.demo.BookRepository">
    </bean>
    
    <bean id="bookService"
        class="com.example.demo.BookService">
        <property name="bookRepository" ref="bookRepository" />
    </bean>
  	<!-- ì—¬ê¸°ê¹Œì§€ ì£¼ëª© -->
  
</beans>
```

<br />
ì´ëŸ° ë¶ˆí¸í•¨ì„ í•´ê²°í•˜ëŠ” ë°©ë²•ì´ Component Scanìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ê²ƒì´ë‹¤.

**application.xml**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd">

   <!-- ì—¬ê¸°ë¶€í„° -->
    <context:component-scan base-package="com.example.demo" />
   <!-- ì—¬ê¸°ê¹Œì§€ ì£¼ëª© -->
</beans>
```

ìœ„ì²˜ëŸ¼ í•´ì£¼ë©´,
 - Bean ë“±ë¡ : @Component, @Service, @Repository, @Configuration+@Bean ì¡°í•© ë“±
 - ì˜ì¡´ì„± ì£¼ì… : @Autowired, ìƒì„±ì, setter ë“±

cf) ì°¸ê³ ë¡œ, @SpringBookApplication ì–´ë…¸í…Œì´ì…˜ì— @ComponentScanì´ ìˆë‹¤.



<br /><br />

--------------------------------------------------------------------------

# 1-2. @Autowired [ğŸ‘†](#ëª©ì°¨)

### **1) ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìœ„ì¹˜**
 - ìƒì„±ì (ìŠ¤í”„ë§ 4.3ë¶€í„°ëŠ” ìƒëµ ê°€ëŠ¥)
 - ì„¸í„°
 - í•„ë“œ

 cf) @Autowired(required = false) ë¼ëŠ” ì˜µì…˜ì„ ì£¼ë©´, ì˜ì¡´ì„± ì£¼ì… ì—†ì´ë„ ìƒì„±ì´ ë˜ê²Œ í•  ìˆ˜ ìˆë‹¤.

<br />

### **2) Beanì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš°, ì²˜ë¦¬ ë°©ë²•**

<br />

*BookRepository.java*

```java
public interface BookRepository{

}
```

*FirstBookRepository.java*
```java
@Repository
public class FirstBookRepository implements BookRepository{

}
```

*SecondBookRepository.java*

```java
@Repository
public class SecondBookRepository implements BookRepository{

}
```

<br />

ì´ë ‡ê²Œ ë˜ë©´, BookRepositoryíƒ€ì…ì˜ Beanì´ 2ê°œê°€ ìƒê²¼ëŠ”ë°, ë‹¤ìŒê³¼ ê°™ì´ BookRepositoryë¥¼ ì£¼ì…ë°›ìœ¼ë ¤ê³  í•˜ë©´, ë‹¤ìŒì˜ ìƒí™©ì—ì„œ FirstBookRepository ì™€ SecondBookRepository ì¤‘ì— ì–´ë–¤ Repositoryë¥¼ ì£¼ì…ë°›ì„ê¹Œ?

<br />

*BookService.java*
```java
@Service
public class BookService{
   @Autowired
   BookRepository bookRepository;
}
```

<br />

### **2-1) ê²°ê³¼**

 : ì—ëŸ¬ê°€ ë‚œë‹¤.

<br />

### **2-2) í•´ê²° ë°©ë²•**

**1. @Primary ì´ìš©** (ì¶”ì²œ)
<br />

 : Beanë“¤ ì¤‘ ê°€ì¥ ìš°ì„ ìˆœìœ„ë¥¼ ë†’ì—¬ì„œ ë‹¤ë¥¸ ê³³ì—ì„œ ì£¼ì…í•˜ë ¤ê³  í•  ë•Œ, @Primary ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” Beanì„ ì£¼ì…ë°›ë„ë¡ í•œë‹¤.

 ```java
@Repository @Primary
public class FirstBookRepository implements BookRepository{

}
 ```
<br />

**2. @Qualifier ì´ìš©**
<br />

 : ì–´ë–¤ Beanì„ ì£¼ì…ë°›ì„ ì§€ë¥¼ ëª…ì‹œí•œë‹¤.

 ```java
@Service
public class BookService{
   @Autowired @Qualifier("FirstBookRepository")
   BookRepository bookRepository;
}
 ```

<br />

**3. ì—¬ëŸ¬ Beanë“¤ ëª¨ë‘ ì£¼ì…**
<br />

 : List íƒ€ì…ìœ¼ë¡œ ì—¬ëŸ¬ Beanë“¤ì„ ëª¨ë‘ ì£¼ì…ë°›ë„ë¡ í•œë‹¤.

```java
@Service
public class BookService{
   @Autowired
   List<BookRepository> bookRepositories;  // FristBookRepository, SecondBookRepsitory
}
```

<br />

**4. íŠ¸ë¦­** (ë¹„ì¶”ì²œ)
<br />

 : í•„ë“œëª…ì„ ì£¼ì…ë°›ê³  ì‹¶ì€ Bean ì´ë¦„ìœ¼ë¡œ í•œë‹¤. (ì²«ê¸€ì ì†Œë¬¸ì, ê·¸ ì™¸ ë™ì¼í•˜ê²Œ)

 ```java
@Service
public class BookService{
   @Autowired
   BookRepository firstBookRepository;
}
 ```


 <br /><br />

--------------------------------------------------------------------------

# 1-3. @ComponentScan [ğŸ‘†](#ëª©ì°¨)

### **1) ìŠ¤ìº” ë™ì‘**

 - @ComponentScan ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” ê³³ë¶€í„° ìŠ¤ìº”ì´ ì‹œì‘ëœë‹¤. 
 - @SpringBootApplicationì´ @ComponentScanì„ ë‹´ê³  ìˆë‹¤.
 - @SpringBootApplicationì´ ìˆëŠ” íŒ¨í‚¤ì§€ ì•ˆì— ìˆëŠ” ê²ƒë“¤ë§Œ ìŠ¤ìº”ì´ ê°€ëŠ¥í•˜ë‹¤.
 - @Component ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” ê²ƒë“¤ì„ ìŠ¤ìº”í•œë‹¤.
 - @Filterë¡œ ìŠ¤ìº”í•  ì»´í¬ë„ŒíŠ¸ë¥¼ í•„í„°ë§í•  ìˆ˜ ìˆë‹¤.


<br />

### **2) ë‹¤ë¥¸ íŒ¨í‚¤ì§€, Bean ë“±ë¡**

: ë‹¤ìŒì€ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ Beanì— ë“±ë¡í•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤.

```java
@SpringBootApplication
public class DemoApplication {

   @Autowired
   OtherPack otherPack;  // ë‹¤ë¥¸ íŒ¨í‚¤ì§€ë¼ intellijê°€ ì—ëŸ¬ë¡œ ì¸ì‹. (í•˜ì§€ë§Œ, ì‹¤í–‰ ì‹œ errorì—†ìŒ.)

	public static void main(String[] args) {
		var app = new SpringApplication(DemoApplication.class);
		app.addInitializers(new ApplicationContextInitializer<GenericApplicationContext>() {
			@Override
			public void initialize(GenericApplicationContext ctx) {
				ctx.registerBean(OtherPack.class);   // ë‹¤ë¥¸ íŒ¨í‚¤ì§€ í´ë˜ìŠ¤ë¥¼ Bean ë“±ë¡
			}
		});
		app.run(args);
	}
}
```


<br />

### **3) @Component**

: ì•„ë˜ì˜ ì–´ë…¸í…Œì´ì…˜ì€ ëª¨ë‘ @Componentë¥¼ ê°€ì§€ê³  ìˆë‹¤.
<br />
- @Repository
- @Service
- @Controller
- @Configuration
<br />


cf) ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ì¸ Beanì€ ì´ˆê¸°ì— ë‹¤ ìƒì„±ì„ í•œë‹¤. (ì´ëŸ° Beanì´ ë§ìœ¼ë©´, ì´ˆê¸° êµ¬ë™ì‹œê°„ì´ ì¡°ê¸ˆ ê±¸ë¦´ ìˆ˜ ìˆë‹¤.)



<br /><br />

--------------------------------------------------------------------------

# 1-4. Bean ìŠ¤ì½”í”„ [ğŸ‘†](#ëª©ì°¨)

### **1) ì‹±ê¸€í†¤**

 - ì–´í”Œë¦¬ì¼€ì´ì…˜ ì „ì—­ì— ê±¸ì³ì„œ í•´ë‹¹ Beanì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ í•˜ë‚˜ì´ë‹¤.
 - ê¸°ë³¸ ìŠ¤ì½”í”„ê°€ ì‹±ê¸€í†¤ì´ë‹¤. (ì‚¬ì‹¤ ëŒ€ë¶€ë¶„ì˜ ê²½ìš°, ì‹±ê¸€í†¤ì„ ì“¸ ê²ƒì„.)




<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ </summary>
<br />

*Single.java*
```java
@Component
public class Single {
    @Autowired
    Proto proto;

    public Proto callProto(){
        return proto;
    }
}
```

*Proto.java*
```java
@Component
public class Proto {
}
```

*ScopeRunner.java*
``` java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    Single single;

    @Autowired
    Proto proto;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println(proto);               // Proto@9cd25ff
        System.out.println(single.callProto());  // Proto@9cd25ff
    }
}
```

<br />

=> ê²°ê³¼ë¥¼ ë³´ë©´, Runnerê°€ ì£¼ì…ë°›ì€ Protoë¼ëŠ” ê°ì²´ì™€, Singleì´ ì£¼ì…ë°›ì€ Protoë¼ëŠ” ê°ì²´ê°€ ì™„ì „íˆ ì¼ì¹˜í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.
</details>




<br /><br />

### **2) í”„ë¡œí† íƒ€ì…**

 - ë§¤ë²ˆ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ. 
 - Beanì„ ë°›ì•„ì˜¬ ë•Œë§Œ, ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ ëœë‹¤.



<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ </summary>
<br />


*Proto.java*
 ```java
@Component @Scope("prototype")
public class Proto{

}
 ```


*ScopeRunner.java*
```java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("Proto");
        System.out.println(ctx.getBean(Proto.class)); // Proto@780ec4a5
        System.out.println(ctx.getBean(Proto.class)); // Proto@e24ddd0
        System.out.println(ctx.getBean(Proto.class)); // Proto@6f70f32f

        System.out.println("Single");
        System.out.println(ctx.getBean(Single.class)); // Single@548e76f1
        System.out.println(ctx.getBean(Single.class)); // Single@548e76f1
        System.out.println(ctx.getBean(Single.class)); // Single@548e76f1
    }
}
```

<br />

=> ê²°ê³¼ë¥¼ ë³´ë©´, Beanì„ ê°€ì§€ê³  ì˜¬ë•Œë§ˆë‹¤, í”„ë¡œí†  íƒ€ì…ì˜ Beanì˜ ê²½ìš°, ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë°˜í™˜ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

</details>



<br /><br />

### **3) í”„ë¡œí† íƒ€ì… ì£¼ì˜ ì‚¬í•­**
<br />

**[ë¬¸ì œ]** ì‹±ê¸€í†¤ ì•ˆì—ì„œ í”„ë¡œí† íƒ€ì… Beanì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ”, ì›ë˜ ì˜ë„í•œ í”„ë¡œí† íƒ€ì…ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ </summary>
<br />

*Single.java*
```java
@Component
public class Single {
    @Autowired
    Proto proto;

    public Proto callProto(){
        return proto;
    }
}
```

*ScopeRunner.java*
```java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("Proto by Single");
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@61a002b1
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@61a002b1
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@61a002b1
    }
}
```

</details>

<br /><br />

**[í•´ê²°]** í”„ë¡œí† íƒ€ì… Beanì„ ì§ì ‘ ì°¸ì¡°í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, Proxyë¥¼ í†µí•´ì„œ ì°¸ì¡°í•˜ë„ë¡ í•˜ë©´ ëœë‹¤.

<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ </summary>
<br />

*Proto.java*

```java
@Component @Scope(value = "prototype", proxyMode = ScopedProxyMode.TARGET_CLASS)
public class Proto {
}
```

*ScopeRunner.java*
```java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("Proto by Single");
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@5bd1ceca
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@30c31dd7
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@499b2a5c
    }
}

```
</details>

<br />

cf) ì°¸ê³  : https://en.wikipedia.org/wiki/Proxy_pattern



<br /><br />

--------------------------------------------------------------------------

# 1-5. Environment [ğŸ‘†](#ëª©ì°¨)

### 1) 
















<br /><br /><br />

# ë©”ëª¨

1. mock ê°ì²´

   : í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ, **ì˜ì¡´ì„± ë¬¸ì œ**ë¡œ íŠ¹ì • ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ”ë° ì–´ë ¤ìš´ ê²½ìš° ë§Œë“œëŠ” ê°€ì§œ ê°ì²´ì´ë‹¤.

   [ì‚¬ìš©ë²•]

   - mockê°ì²´ë¥¼ ë§Œë“ ë‹¤. 
     - mock() í•¨ìˆ˜ ì´ìš©
     - @Mockì´ìš©
   - when(A).thenReturn(B); 

   [ì˜ˆì‹œ]

   ```java
   @Mock
   BookRepository bookRepository; // calë©”ì†Œë“œ : 10ì„ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œ
   
   @Test
   public void calTest(){
     when(bookRepository.cal()).thenReturn(10);
   }
   ```

   


