# ëª©ì°¨

1. [IoC ì»¨í…Œì´ë„ˆ](#1-ioc-ì»¨í…Œì´ë„ˆ-)
<br /></t>
   1.1 [ApplicationContext](#1-1-applicationcontext-)
<br /></t>
   1.2 [Autowired](#1-2-autowired-)
<br /></t>
   1.3 [ComponentScan](#1-3-componentscan-)
<br /></t>
   1.4 [Bean ìŠ¤ì½”í”„](#1-4-bean-ìŠ¤ì½”í”„-)
<br /></t>
   1.5 [Environment](#1-5-environment-)
<br /></t>
   1.6 [MessageSource](#1-6-messagesource-)
<br /></t>
   1.7 [ApplicationEventPublisher](#1-7-applicationeventpublisher-)
<br /></t>
   1.8 [ResourceLoader](#1-8-resourceloader-)
2. [Resource ì¶”ìƒí™”](#2-resource-ì¶”ìƒí™”-)
3. [Validation ì¶”ìƒí™”](#3-Validation-ì¶”ìƒí™”-)
4. ë°ì´í„° ë°”ì¸ë”©
5. SpEL
6. ìŠ¤í”„ë§ AOP
7. Null-Safety





<br /><br />

--------------------------------------------------------------------------

# 1. IoC ì»¨í…Œì´ë„ˆ [ğŸ‘†](#ëª©ì°¨)

## ì •ì˜

### 1) IoC 

 : ì–´ë–¤ ê°ì²´ê°€ ì‚¬ìš©í•˜ëŠ” ì˜ì¡´ ê°ì²´ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, ì£¼ì… ë°›ì•„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.

ì‰½ê²Œ ë§í•˜ë©´,

```java
private BookRepository bookRepository;
```

ì´ë ‡ê²Œë§Œ ì„ ì–¸í•˜ë©´ nullì¼í…ë°, ìŠ¤í”„ë§ì´ `bookRepository` ì— ëŒ€í•œ ì •ë³´ë¥¼ ì£¼ì…ì„ í•´ì¤˜ì„œ ë°”ë¡œ ì‚¬ìš©ì„ í•  ìˆ˜ ìˆë‹¤.



<br />

### 2) IoC ì»¨í…Œì´ë„ˆ 

 : Beanë“¤ì„ ê°€ì§€ê³  IoC ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì»¨í…Œì´ë„ˆì´ë‹¤.

ex)

- BeanFactory : IoCì»¨í…Œì´ë„ˆ ìµœìƒìœ„ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.
- ApplicationContext : BeanFactoryë¥¼ ìƒì†ë°›ì€ IoCì»¨í…Œì´ë„ˆë¡œ, ê°€ì¥ ë§ì´ ì‚¬ìš©í•œë‹¤.



<br />

### 3) Bean

 : **IoC ì»¨í…Œì´ë„ˆì— ì˜í•´ ê´€ë¦¬ë˜ëŠ” ê°ì²´**ì´ë‹¤.

#### ì¥ì 

1. IoCì»¨í…Œì´ë„ˆì— ì˜í•´ **ì˜ì¡´ì„± ê´€ë¦¬**ê°€ ëœë‹¤.

2. IoCì»¨í…Œì´ë„ˆì— ë“±ë¡ëœ Beanì€ ê¸°ë³¸ì ìœ¼ë¡œ **ì‹±ê¸€í†¤**ìœ¼ë¡œ ë“±ë¡ë˜ì–´ ì‹±ê¸€í†¤ìœ¼ë¡œ ì‚¬ìš©í•˜ë ¤ê³  í•  ë•Œ, í¸í•˜ë‹¤.

   cf) ìŠ¤ì½”í”„

   - ì‹±ê¸€í†¤ : í•˜ë‚˜ë§Œ ë§Œë“¤ì–´ì„œ ì „ì²´ì— ì‚¬ìš©í•˜ëŠ”ê²ƒ
   - í”„ë¡œí† íƒ€ì… : ë§¤ë²ˆ ë‹¤ë¥¸ ê°ì²´

3. **ë¼ì´í”„ ì‚¬ì´í´ ì¸í„°í˜ì´ìŠ¤** ë¡œ ë¶€ê°€ì ì¸ ì‘ì—…ì„ í•  ìˆ˜ ìˆë‹¤.

   (Beanì— ë“±ë¡ë˜ë©´ì„œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œë“¤ì„ ì´ìš©í•˜ëŠ” ê²½ìš°ë¥¼ ë§í•œë‹¤.)



<br /><br />

--------------------------------------------------------------------------

# 1-1. ApplicationContext [ğŸ‘†](#ëª©ì°¨)

## 1) (ê³ ì „ì ì¸) Bean ë“±ë¡ ë°©ë²•

: ìŠ¤í”„ë§ IoC ì»¨í…Œì´ë„ˆëŠ” ë¹ˆì„¤ì •(xml) íŒŒì¼ì´ ìˆì–´ì•¼í•œë‹¤. ê°€ë ¹, `BookService` ê°€ `BookRepository` ë¥¼ ì£¼ì…ë°›ëŠ”ë‹¤ê³  í•´ë³´ì.

```java
public class BookService{
   BookRepository bookRepository;

   public void setBookRepository(BookRepository bookRepository){
      this.bookRepository = bookRepository;
   }
}
```

ì´ë¥¼ ìœ„í•´ì„œëŠ”, ë‹¤ìŒê³¼ ê°™ì´ ì¼ì¼ì´ Beanìœ¼ë¡œ ë“±ë¡ì„ í•´ì¤˜ì•¼ í–ˆë‹¤.

**application.xml**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

  	<!-- ì—¬ê¸°ë¶€í„° -->
    <bean id="bookRepository"
        class="com.example.demo.BookRepository">
    </bean>
    
    <bean id="bookService"
        class="com.example.demo.BookService">
        <property name="bookRepository" ref="bookRepository" />
    </bean>
  	<!-- ì—¬ê¸°ê¹Œì§€ ì£¼ëª© -->
  
</beans>
```

<br />
ì´ëŸ° ë¶ˆí¸í•¨ì„ í•´ê²°í•˜ëŠ” ë°©ë²•ì´ Component Scanìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ê²ƒì´ë‹¤.

**application.xml**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd">

   <!-- ì—¬ê¸°ë¶€í„° -->
    <context:component-scan base-package="com.example.demo" />
   <!-- ì—¬ê¸°ê¹Œì§€ ì£¼ëª© -->
</beans>
```

ìœ„ì²˜ëŸ¼ í•´ì£¼ë©´,
 - Bean ë“±ë¡ : @Component, @Service, @Repository, @Configuration+@Bean ì¡°í•© ë“±
 - ì˜ì¡´ì„± ì£¼ì… : @Autowired, ìƒì„±ì, setter ë“±

cf) ì°¸ê³ ë¡œ, @SpringBookApplication ì–´ë…¸í…Œì´ì…˜ì— @ComponentScanì´ ìˆë‹¤.



<br /><br />

--------------------------------------------------------------------------

# 1-2. @Autowired [ğŸ‘†](#ëª©ì°¨)

## **1) ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìœ„ì¹˜**
 - ìƒì„±ì (ìŠ¤í”„ë§ 4.3ë¶€í„°ëŠ” ìƒëµ ê°€ëŠ¥)
 - ì„¸í„°
 - í•„ë“œ

 cf) @Autowired(required = false) ë¼ëŠ” ì˜µì…˜ì„ ì£¼ë©´, ì˜ì¡´ì„± ì£¼ì… ì—†ì´ë„ ìƒì„±ì´ ë˜ê²Œ í•  ìˆ˜ ìˆë‹¤.

<br />

## **2) Beanì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš°, ì²˜ë¦¬ ë°©ë²•**

<br />

*BookRepository.java*

```java
public interface BookRepository{

}
```

*FirstBookRepository.java*
```java
@Repository
public class FirstBookRepository implements BookRepository{

}
```

*SecondBookRepository.java*

```java
@Repository
public class SecondBookRepository implements BookRepository{

}
```

<br />

ì´ë ‡ê²Œ ë˜ë©´, BookRepositoryíƒ€ì…ì˜ Beanì´ 2ê°œê°€ ìƒê²¼ëŠ”ë°, ë‹¤ìŒê³¼ ê°™ì´ BookRepositoryë¥¼ ì£¼ì…ë°›ìœ¼ë ¤ê³  í•˜ë©´, ë‹¤ìŒì˜ ìƒí™©ì—ì„œ FirstBookRepository ì™€ SecondBookRepository ì¤‘ì— ì–´ë–¤ Repositoryë¥¼ ì£¼ì…ë°›ì„ê¹Œ?

<br />

*BookService.java*
```java
@Service
public class BookService{
   @Autowired
   BookRepository bookRepository;
}
```

<br />

## **2-1) ê²°ê³¼**

 : ì—ëŸ¬ê°€ ë‚œë‹¤.

<br />

## **2-2) í•´ê²° ë°©ë²•**

**1. @Primary ì´ìš©** (ì¶”ì²œ)
<br />

 : Beanë“¤ ì¤‘ ê°€ì¥ ìš°ì„ ìˆœìœ„ë¥¼ ë†’ì—¬ì„œ ë‹¤ë¥¸ ê³³ì—ì„œ ì£¼ì…í•˜ë ¤ê³  í•  ë•Œ, @Primary ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” Beanì„ ì£¼ì…ë°›ë„ë¡ í•œë‹¤.

 ```java
@Repository @Primary
public class FirstBookRepository implements BookRepository{

}
 ```
<br />

**2. @Qualifier ì´ìš©**
<br />

 : ì–´ë–¤ Beanì„ ì£¼ì…ë°›ì„ ì§€ë¥¼ ëª…ì‹œí•œë‹¤.

 ```java
@Service
public class BookService{
   @Autowired @Qualifier("FirstBookRepository")
   BookRepository bookRepository;
}
 ```

<br />

**3. ì—¬ëŸ¬ Beanë“¤ ëª¨ë‘ ì£¼ì…**
<br />

 : List íƒ€ì…ìœ¼ë¡œ ì—¬ëŸ¬ Beanë“¤ì„ ëª¨ë‘ ì£¼ì…ë°›ë„ë¡ í•œë‹¤.

```java
@Service
public class BookService{
   @Autowired
   List<BookRepository> bookRepositories;  // FristBookRepository, SecondBookRepsitory
}
```

<br />

**4. íŠ¸ë¦­** (ë¹„ì¶”ì²œ)
<br />

 : í•„ë“œëª…ì„ ì£¼ì…ë°›ê³  ì‹¶ì€ Bean ì´ë¦„ìœ¼ë¡œ í•œë‹¤. (ì²«ê¸€ì ì†Œë¬¸ì, ê·¸ ì™¸ ë™ì¼í•˜ê²Œ)

 ```java
@Service
public class BookService{
   @Autowired
   BookRepository firstBookRepository;
}
 ```


 <br /><br />

--------------------------------------------------------------------------

# 1-3. @ComponentScan [ğŸ‘†](#ëª©ì°¨)

## **1) ìŠ¤ìº” ë™ì‘**

 - @ComponentScan ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” ê³³ë¶€í„° ìŠ¤ìº”ì´ ì‹œì‘ëœë‹¤. 
 - @SpringBootApplicationì´ @ComponentScanì„ ë‹´ê³  ìˆë‹¤.
 - @SpringBootApplicationì´ ìˆëŠ” íŒ¨í‚¤ì§€ ì•ˆì— ìˆëŠ” ê²ƒë“¤ë§Œ ìŠ¤ìº”ì´ ê°€ëŠ¥í•˜ë‹¤.
 - @Component ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” ê²ƒë“¤ì„ ìŠ¤ìº”í•œë‹¤.
 - @Filterë¡œ ìŠ¤ìº”í•  ì»´í¬ë„ŒíŠ¸ë¥¼ í•„í„°ë§í•  ìˆ˜ ìˆë‹¤.


<br />

## **2) ë‹¤ë¥¸ íŒ¨í‚¤ì§€, Bean ë“±ë¡**

: ë‹¤ìŒì€ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ Beanì— ë“±ë¡í•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤.

```java
@SpringBootApplication
public class DemoApplication {

   @Autowired
   OtherPack otherPack;  // ë‹¤ë¥¸ íŒ¨í‚¤ì§€ë¼ intellijê°€ ì—ëŸ¬ë¡œ ì¸ì‹. (í•˜ì§€ë§Œ, ì‹¤í–‰ ì‹œ errorì—†ìŒ.)

	public static void main(String[] args) {
		var app = new SpringApplication(DemoApplication.class);
		app.addInitializers(new ApplicationContextInitializer<GenericApplicationContext>() {
			@Override
			public void initialize(GenericApplicationContext ctx) {
				ctx.registerBean(OtherPack.class);   // ë‹¤ë¥¸ íŒ¨í‚¤ì§€ í´ë˜ìŠ¤ë¥¼ Bean ë“±ë¡
			}
		});
		app.run(args);
	}
}
```


<br />

## **3) @Component**

: ì•„ë˜ì˜ ì–´ë…¸í…Œì´ì…˜ì€ ëª¨ë‘ @Componentë¥¼ ê°€ì§€ê³  ìˆë‹¤.
<br />
- @Repository
- @Service
- @Controller
- @Configuration
<br />


cf) ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ì¸ Beanì€ ì´ˆê¸°ì— ë‹¤ ìƒì„±ì„ í•œë‹¤. (ì´ëŸ° Beanì´ ë§ìœ¼ë©´, ì´ˆê¸° êµ¬ë™ì‹œê°„ì´ ì¡°ê¸ˆ ê±¸ë¦´ ìˆ˜ ìˆë‹¤.)



<br /><br />

--------------------------------------------------------------------------

# 1-4. Bean ìŠ¤ì½”í”„ [ğŸ‘†](#ëª©ì°¨)

## **1) ì‹±ê¸€í†¤**

 - ì–´í”Œë¦¬ì¼€ì´ì…˜ ì „ì—­ì— ê±¸ì³ì„œ í•´ë‹¹ Beanì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ í•˜ë‚˜ì´ë‹¤.
 - ê¸°ë³¸ ìŠ¤ì½”í”„ê°€ ì‹±ê¸€í†¤ì´ë‹¤. (ì‚¬ì‹¤ ëŒ€ë¶€ë¶„ì˜ ê²½ìš°, ì‹±ê¸€í†¤ì„ ì“¸ ê²ƒì„.)




<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
<br />

*Single.java*
```java
@Component
public class Single {
    @Autowired
    Proto proto;

    public Proto callProto(){
        return proto;
    }
}
```

*Proto.java*
```java
@Component
public class Proto {
}
```

*ScopeRunner.java*
``` java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    Single single;

    @Autowired
    Proto proto;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println(proto);               // Proto@9cd25ff
        System.out.println(single.callProto());  // Proto@9cd25ff
    }
}
```

<br />

=> ê²°ê³¼ë¥¼ ë³´ë©´, Runnerê°€ ì£¼ì…ë°›ì€ Protoë¼ëŠ” ê°ì²´ì™€, Singleì´ ì£¼ì…ë°›ì€ Protoë¼ëŠ” ê°ì²´ê°€ ì™„ì „íˆ ì¼ì¹˜í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.
</details>




<br /><br />

## **2) í”„ë¡œí† íƒ€ì…**

 - ë§¤ë²ˆ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ. 
 - Beanì„ ë°›ì•„ì˜¬ ë•Œë§Œ, ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ ëœë‹¤.



<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
<br />


*Proto.java*
 ```java
@Component @Scope("prototype")
public class Proto{

}
 ```


*ScopeRunner.java*
```java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("Proto");
        System.out.println(ctx.getBean(Proto.class)); // Proto@780ec4a5
        System.out.println(ctx.getBean(Proto.class)); // Proto@e24ddd0
        System.out.println(ctx.getBean(Proto.class)); // Proto@6f70f32f

        System.out.println("Single");
        System.out.println(ctx.getBean(Single.class)); // Single@548e76f1
        System.out.println(ctx.getBean(Single.class)); // Single@548e76f1
        System.out.println(ctx.getBean(Single.class)); // Single@548e76f1
    }
}
```

<br />

=> ê²°ê³¼ë¥¼ ë³´ë©´, Beanì„ ê°€ì§€ê³  ì˜¬ë•Œë§ˆë‹¤, í”„ë¡œí†  íƒ€ì…ì˜ Beanì˜ ê²½ìš°, ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë°˜í™˜ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

</details>



<br /><br />

## **3) í”„ë¡œí† íƒ€ì… ì£¼ì˜ ì‚¬í•­**
<br />

**[ë¬¸ì œ]** ì‹±ê¸€í†¤ ì•ˆì—ì„œ í”„ë¡œí† íƒ€ì… Beanì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ”, ì›ë˜ ì˜ë„í•œ í”„ë¡œí† íƒ€ì…ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
<br />

*Single.java*
```java
@Component
public class Single {
    @Autowired
    Proto proto;

    public Proto callProto(){
        return proto;
    }
}
```

*ScopeRunner.java*
```java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("Proto by Single");
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@61a002b1
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@61a002b1
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@61a002b1
    }
}
```

</details>

<br /><br />

**[í•´ê²°]** í”„ë¡œí† íƒ€ì… Beanì„ ì§ì ‘ ì°¸ì¡°í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, Proxyë¥¼ í†µí•´ì„œ ì°¸ì¡°í•˜ë„ë¡ í•˜ë©´ ëœë‹¤.

<details>
   <summary> ì˜ˆì‹œ ì†ŒìŠ¤ì½”ë“œ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
<br />

*Proto.java*

```java
@Component @Scope(value = "prototype", proxyMode = ScopedProxyMode.TARGET_CLASS)
public class Proto {
}
```

*ScopeRunner.java*
```java
@Component
public class ScopeRunner implements ApplicationRunner {

    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("Proto by Single");
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@5bd1ceca
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@30c31dd7
        System.out.println(ctx.getBean(Single.class).callProto()); // Proto@499b2a5c
    }
}

```
</details>

<br />

cf) ì°¸ê³  : https://en.wikipedia.org/wiki/Proxy_pattern



<br /><br />

--------------------------------------------------------------------------

# 1-5. Environment [ğŸ‘†](#ëª©ì°¨)

: Test/Productionê³¼ ê°™ì€ í™˜ê²½ì„ ë‹¤ë£¨ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ, @Profile, @Property ê°€ ìˆë‹¤.

<br />

--------------------------------------------------------------------------
## @Profile 

: Beanë“¤ì„ `test`ì¼ ë•Œë§Œ í˜¹ì€ `prod`ì¼ ë•Œë§Œ ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

<br />

### **[Profile ì‚¬ìš©ë°©ë²•]**

### **1. Beanì— ì ìš©**

   : **í´ë˜ìŠ¤ì— @Profileì„ ì ìš©** í•˜ê±°ë‚˜ **ë©”ì†Œë“œì— @Profileì„ ì ìš©** í•œë‹¤. (ë‘ê°€ì§€ ë°©ë²•ì´ ìˆìŒ.)

   <br />

   1) **í´ë˜ìŠ¤** ì— ì ìš©

      ```java
      @Configuration @Profile("test")
      ```

      <details>
         <summary> ì˜ˆì‹œ ì½”ë“œ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
      <br />

      *EnConfiguration.java*
      ```java
      @Configuration
      @Profile("test")  // ì—¬ê¸°ì— test, prod, !test, !prod, ...
      public class EnConfiguration {
         @Bean
         public BookService bookService(){
            return new BookService();
         }
      }
      ```
      </details>

   <br />

   2. **ë©”ì†Œë“œ** ì— ì ìš©

      ```java
      @Bean @Profile("test")
      ```

      <details>
         <summary> ì˜ˆì‹œ ì½”ë“œ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
      <br />

      *EnConfiguration.java*

      ```java
      @Configuration
      public class EnConfiguration {
         @Bean 
         @Profile("test")  ì—¬ê¸°ì— test, prod, !test, !prod, ...
         public BookService bookService(){
            return new BookService();
         }
      }
      ```

      <br />

      ë¬¼ë¡ , ê·¸ëƒ¥ ë°”ë¡œ ì¤˜ë„ ë¨.

      *BookService.java*

      ```java
      @Service
      @Profile("test")
      public class BookService {
         @Autowired
         BookRepository bookRepository;
      }
      ```

      </details>

<br />

### 2. **VM ì„¤ì •í•˜ê¸°**

   : Beanì— Profileì„ ë“±ë¡í–ˆë‹¤ë©´ ë‹¤ìŒìœ¼ë¡œ VMì„ ì„¤ì •í•œë‹¤. (ë‘ê°€ì§€ ë°©ë²•ì´ ìˆìŒ.)

   <details>
      <summary> 1ë²ˆ ë°©ë²• â­ï¸(ëˆ„ë¥´ê¸°) </summary>
   <br />

   <div align=center>
      <img src="./assets/2.png" />
   </div>

   </details>

   <br />
   

   <details>
      <summary> 2ë²ˆ ë°©ë²• â­ï¸(ëˆ„ë¥´ê¸°) </summary>
   <br />

   <div align=center>
      <img src="./assets/3.png" />
   </div>

   </details>






<br /><br />

--------------------------------------------------------------------------
## @Property

 - ì–´í”Œë¦¬ì¼€ì´ì…˜ì— ë“±ë¡í•  ìˆ˜ ìˆëŠ” {key:value}ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì†ì„±ì´ë‹¤.
 - í”„ë¡œí¼í‹°ì—ëŠ” ìš°ì„ ìˆœìœ„ê°€ ìˆë‹¤.
 - ê°’ì„ ì£¼ëŠ” ë°©ë²•ì€, VM optionì— '-D' ë¡œ ì¤„ ìˆ˜ ìˆë‹¤. (ex) -Dapp.name=spring5)

<br />

### **1. ê°’ í™•ì¸í•˜ê¸°**

: Environment í´ë˜ìŠ¤ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

*EnRunner.java*
```java
@Component
public class EnRunner implements ApplicationRunner {

    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        Environment environment = ctx.getEnvironment();
        System.out.println(environment.getProperty("spring.profiles.active"));
    }
}
```

<br />

### **2. ê°’ í• ë‹¹í•˜ê¸°**

: **JVM ì‹œìŠ¤í…œ í”„ë¡œí¼í‹°** ë¡œ ì¤„ ìˆ˜ë„ ìˆê³ , **@PropertySource** ë‚˜ **@Value** ë¡œ ì¤„ ìˆ˜ë„ ìˆë‹¤.

   1. JVM ì‹œìŠ¤í…œ í”„ë¡œí¼í‹° (-Dë¡œ ì£¼ëŠ” ê²ƒ)

      <details>
         <summary> ìƒì„¸ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
      <br />

      <div align=center>
         <img src="./assets/3.png" />
      </div>

      </details>
      <br />

   2. @PropertySource 

      <details>
         <summary> ìƒì„¸ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
      <br />

      *resource/app.properties*
      ```java
      spring.profiles.active=test
      ```

      *EnRunner.java*
      ```java
      @Component
      @PropertySource("classpath:/app.properties")  // ì—¬ê¸°!
      public class EnRunner implements ApplicationRunner {

         @Autowired
         ApplicationContext ctx;

         @Override
         public void run(ApplicationArguments args) throws Exception {
            Environment environment = ctx.getEnvironment();
            System.out.println(environment.getProperty("spring.profiles.active"));
         }
      }
      ```
      
      </details>
      
      <br />

   3. @Value

      <details>
         <summary> ìƒì„¸ â­ï¸(ëˆ„ë¥´ê¸°) </summary>
      <br />

      *EnRunner.java*
      ```java
      @Component
      public class EnRunner implements ApplicationRunner {

         @Value("${spring.profiles.active}") // ì—¬ê¸°!
         String pro;

         @Override
         public void run(ApplicationArguments args) throws Exception {
            System.out.println(pro);
         }
      }
      ```

      </details>


   cf) ì°¸ê³ ë¡œ, **ìš°ì„ ìˆœìœ„ëŠ” JVM ì‹œìŠ¤í…œ í”„ë¡œí¼í‹°ê°€ ë†’ë‹¤.**



<br /><br />

--------------------------------------------------------------------------

# 1-6. MessageSource [ğŸ‘†](#ëª©ì°¨)

: ë©”ì„¸ì§€ë¥¼ ë‹¤êµ­í™”í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. 

 - ApplicationContextê°€ MessageSourceë¥¼ ê°€ì§€ê³  ìˆë‹¤.
 - Springbootë¥¼ ì‚¬ìš©í•˜ë©´ MessageSourceëŠ” ìë™ìœ¼ë¡œ Beanìœ¼ë¡œ ë“±ë¡ëœë‹¤.

<br />

 ## 1. ì‚¬ìš©ë²•

 : ë‹¨ì–´ ë§µí•‘ì„ ë¦¬ì†ŒìŠ¤ ë²ˆë“¤ë¡œ ì„¤ì •í•´ë‘ë©´, MessageSourceê°€ ì´ë¥¼ êµ¬ë¶„í•˜ì—¬ ì½ëŠ”ë‹¤.

*resources/messages.properties*

```java
greeting=Hello, {0}
```

*resources/messages_ko_KR.properties*

```java
greeting=ì•ˆë…•, {0}
```

*AppRunner.java*

```java
@Component
public class AppRunner implements ApplicationRunner {

    @Autowired
    MessageSource messageSource;
    
    @Override
    public void run(ApplicationArguments args) throws Exception {
        Locale.setDefault(new Locale("en", "US"));

        // ë„˜ê²¨ì¤„ ë•Œ, íŒŒë¼ë¯¸í„°ë„ í•¨ê»˜ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.
        System.out.println(messageSource.getMessage("greeting", new String[]{"Sangjin"}, Locale.KOREA));   // ì•ˆë…•, Sangjin
        System.out.println(messageSource.getMessage("greeting", new String[]{"Sangjin"}, Locale.getDefault()));  // Hello, Sangjin
    }
}
```



<br /><br />

--------------------------------------------------------------------------

# 1-7. ApplicationEventPublisher [ğŸ‘†](#ëª©ì°¨)

: **ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤** ì´ë‹¤.

: êµ¬ì¡° : Publisher(ì´ë²¤íŠ¸ ë°œìƒâ€¼ï¸) -> EventHandler(Event ì²˜ë¦¬)

- ì—­ì‹œ ApplicationConextëŠ” ApplicationEventPublisherë¥¼ ìƒì†ë°›ëŠ”ë‹¤.
- ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ì£¼ì²´ëŠ” ApplicationEventPublisherì´ë‹¤ .
- Event í´ë˜ìŠ¤ëŠ” Beanìœ¼ë¡œ ë“±ë¡ì´ í•„ìš”ì—†ë‹¤.
- Event í´ë˜ìŠ¤ëŠ” ìŠ¤í”„ë§4.2ê¹Œì§€ëŠ” ApplicationEventë¥¼ ìƒì†ë°›ì•„ì•¼ í–ˆë‹¤. (ì§€ê¸ˆì€ X)
- EventHandler í´ë˜ìŠ¤ëŠ” Beanìœ¼ë¡œ ë“±ë¡í•´ì•¼ í•œë‹¤.
- EventHandler í´ë˜ìŠ¤ëŠ” ìŠ¤í”„ë§4ê¹Œì§€ëŠ” ApplicationListenerë¥¼ êµ¬í˜„í•´ì•¼ í–ˆë‹¤. 

   (ì§€ê¸ˆì€ ë©”ì„œë“œì— @EventListener ë¼ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ ë‹¨ë‹¤.)

<br />

<details>
   <summary> ê¸°ë³¸ ì˜ˆì œ ë³´ê¸° â­ï¸(ëˆ„ë¥´ê¸°) </summary>
<br />

*MyEvent.java*
```java
public class MyEvent {
    private Object source;
    private int data;

    public MyEvent(Object source, int data){
        this.source = source;
        this.data = data;
    }

    public Object getSource() {
        return source;
    }

    public int getData() {
        return data;
    }
}
```

*MyEventHandler.java* 
```java
@Component
public class MyEventHandler {
    @EventListener
    public void myHandle(MyEvent event){
        System.out.println("ì´ë²¤íŠ¸ ë°œìƒ / ë°ì´í„° : " + event.getData());
    }
}

```

*AppRunner.java*
```java
@Component
public class AppRunner implements ApplicationRunner {

    @Autowired
    ApplicationEventPublisher publisher;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        publisher.publishEvent(new MyEvent(this, 100));  // ì´ë²¤íŠ¸ ë°œìƒ / ë°ì´í„° : 100
    }
}

```

</details>

<br />

## **Handlerê°€ 2ê°œë¼ë©´**

: í•˜ë‚˜ì˜ ì´ë²¤íŠ¸ë¥¼ 2ê°œ ì´ìƒì˜ í•¸ë“¤ëŸ¬ê°€ ì²˜ë¦¬í•˜ëŠ” êµ¬ì¡°ì¼ ë•Œ, ìš°ì„ ìˆœìœ„ ì£¼ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- @Orderë¥¼ ì´ìš©í•œë‹¤.
- ìˆ«ìê°€ ë‚®ì€ê²Œ ìš°ì„ ìˆœìœ„ê°€ ë†’ë‹¤.

*MyHandler.java*
```java
@Component
public class MyEventHandler {
    @EventListener
    @Order(1)
    public void myHandle(MyEvent event){
        System.out.println("ì´ë²¤íŠ¸ ë°œìƒ / ë°ì´í„° : " + event.getData());
    }
}
```

*AnotherHandler.java*
```java
@Component
public class AnotherHandler {
    @EventListener
    @Order(2)
    public void handle(MyEvent event){
        System.out.println("Another "+ event.getData());
    }
}
```



<br />

## **ì¶”ê°€ Tips**

1. í•œ Threadê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ëŠ”ì§€, ì—¬ëŸ¬ Threadê°€ ê°œì…í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•

   : ê¶ê¸ˆí•œ ì½”ë“œì— í˜„ì¬ ì“°ë ˆë“œë¥¼ ì¶œë ¥í•´ë³¸ë‹¤.

   ```java
   System.out.println(Thread.currentThread());
   ```

<br />

2. ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•˜ëŠ” ë°©ë²•

   : @Asyncë¥¼ ì‚¬ìš©í•œë‹¤. (ApplicationRunnerì— @EnableAsync ì¶”ê°€í•´ì•¼í•¨.)

   ```java
   @Component
   public class MyEventHandler {
      @EventListener
      @Async
      public void myHandle(MyEvent event){
         System.out.println("ì´ë²¤íŠ¸ ë°œìƒ / ë°ì´í„° : " + event.getData());
      }
   }
   ```

<br />

3. íŠ¹ë³„í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬

   (1) ContextRefreshedEvent

      : IoCì»¨í…Œì´ë„ˆ(ApplicationContext)ê°€ ì‹œì‘ë ë•Œ í˜¹ì€ ìƒˆë¡œê³ ì¹¨ë ë•Œ ë°œìƒí•œë‹¤.

      *MyHandler.java*
      ```java
      @EventListener
      public void handle(ContextRefreshedEvent event){
         System.out.println("ContextRefreshedEvent");
      }
      ```

   (2) ContextClosedEvent

      : ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì¢…ë£Œë ë•Œ ë°œìƒí•œë‹¤.

      *MyHandler.java*
      ```java
      @EventListener
      public void handle(ContextClosedEvent event){
         System.out.println("ContextRefreshedEvent");
      }

      ```


<br /><br />

--------------------------------------------------------------------------

# 1-8. ResourceLoader [ğŸ‘†](#ëª©ì°¨)

: ë¦¬ì†ŒìŠ¤ë¥¼ ì½ì–´ì˜¬ ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤

ex)ë‚´ê°€ ë§Œë“  í…ìŠ¤íŠ¸ íŒŒì¼ ì½ì–´ì˜¬ ìˆ˜ ìˆëŠ” ê²ƒ.

<br />

<details>
   <summary> ê¸°ë³¸ ì˜ˆì œ ë³´ê¸° â­ï¸(ëˆ„ë¥´ê¸°) </summary>
<br />

*resources/test.txt*
```txt
hello spring
```

*AppRunner.java*
```java
@Component
public class AppRunner implements ApplicationRunner {
    @Autowired
    ResourceLoader loader;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        Resource resource = loader.getResource("classpath:test.txt");
        if(resource.exists()){
            String content = Files.readString(Path.of(resource.getURI()));
            System.out.println(content);
        }
    }
}
```

<br />

cf) `classpath` ë£¨íŠ¸ëŠ” => `target/classes` ì´ë‹¤. 

</details>


<br /><br />

--------------------------------------------------------------------------

# 2. Resource ì¶”ìƒí™” [ğŸ‘†](#ëª©ì°¨)

 : ìë°”ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œ, `java.net.URL` ë¡œ í•œë‹¤. ê·¸ëŸ°ë°, ìŠ¤í”„ë§ ì…ì¥ì—ì„œëŠ” classpathë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì•„ê°€ëŠ” ê²ƒë„ í•„ìš”í•˜ë‹¤. ê·¸ë˜ì„œ `java.net.URL` ë¥¼ ì¶”ìƒí™”í•œ `Resource` ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ê°€ ë“±ì¥í–ˆë‹¤. 


<br />

## **ì–¸ì œ ì“°ì´ëŠ”ê°€?**

 : ìš°ë¦¬ê°€ ì•Œê²Œ ëª¨ë¥´ê²Œ ë§ì€ ê³³ì—ì„œ ì“°ì¸ë‹¤. ApplicationContextë¥¼ ë§Œë“¤ ë•Œ, xmlë¥¼ ì°¾ì•„ì„œ ë§Œë“¤ê²Œ ë˜ëŠ”ë°, xmlì„ ì°¾ëŠ” ë°©ë²•ì´ ì—¬ëŸ¬ê°œê°€ ìˆë‹¤.

 (1) classpathë¥¼ ê¸°ì¤€ìœ¼ë¡œ xmlì°¾ê¸°

   *AppRunner.java*
   ```java
   var ctx = new ClassPathXmlApplicationContext("xxx.xml");  
   // "xxx.xml" íƒ€ì…ì€ ClassPathResource
   ```

<br />

 (2) íŒŒì¼ì‹œìŠ¤í…œì„ ê¸°ì¤€ìœ¼ë¡œ xmlì°¾ê¸°

   *AppRunner.java*
   ```java
   var ctx = new FileSystemXmlApplicationContext("xxx.xml");
   // "xxx.xml" íƒ€ì…ì€ FileSystemResource
   ```
   

<br />

=> *ìœ„ì²˜ëŸ¼ **Resourceíƒ€ì…** ì€ **ApplicationContextì˜ íƒ€ì…ì— ë”°ë¼ ê²°ì •** ëœë‹¤.*

cf) íƒ€ì…ì€ ì–´ë–»ê²Œ í™•ì¸í• ê¹Œ?

<details>
   <summary> ì˜ˆì‹œ ë³´ê¸° â­ï¸(ëˆ„ë¥´ê¸°) </summary>
<br />

*AppRunner.java*
```java
@Component
public class AppRunner implements ApplicationRunner {
    @Autowired
    ApplicationContext ctx;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println(ctx.getClass()); 
               // AnnotationConfigServletWebServerApplicationContext
    }
}
```

</details>

<br /><br />

## **Resource êµ¬í˜„ì²´**

- UrlResource
- ClassPathResource
- FileSystemResource
- ServletContextResource


<br />

## **ì‚¬ìš© Tips**

: ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ”, **ë¦¬ì†ŒìŠ¤ íƒ€ì…ì„ ëª…ì‹œ** í•´ì£¼ì!

- classpath:[ìœ„ì¹˜]

- file:///[ìœ„ì¹˜]

=> ë§Œì•½, ClassPathXmlApplicationContext ë¼ë©´, ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œ, [ìœ„ì¹˜]ë¥¼ ì„¤ëª…í•  ë•Œ ë””í´íŠ¸ê°€ classpathê¸°ì¤€ì´ë‹¤.
í•˜ì§€ë§Œ, ì‚¬ìš©í•  ë•ŒëŠ” ê¼­ ë¦¬ì†ŒìŠ¤ íƒ€ì…ì„ ëª…ì‹œí•´ì£¼ì. 

*AppRunner.java* (ctx íƒ€ì…ê³¼ ìƒê´€ì—†ì´)
```java
Resource resource = ctx.getResource("classpath:test.txt"); // classpath ê¸°ì¤€ì¼ ë•Œ
Resource resource = ctx.getResource("file:///test.txt");   // íŒŒì¼ì‹œìŠ¤í…œ ê¸°ì¤€ì¼ ë•Œ
```

=> ëŒ€ë¶€ë¶„ì˜ ê²½ìš°, WebApplicationContextë¼ì„œ ServletContextResourceë¥¼ ì‚¬ìš©í•˜ê² ì§€ë§Œ, ìŠµê´€ì„ ìœ„ì²˜ëŸ¼ ë“¤ì—¬ë‘ì.


<br /><br />

--------------------------------------------------------------------------

# 3. Validation ì¶”ìƒí™” [ğŸ‘†](#ëª©ì°¨)

 : 


<br /><br /><br />

# ë©”ëª¨

1. mock ê°ì²´

   : í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ, **ì˜ì¡´ì„± ë¬¸ì œ**ë¡œ íŠ¹ì • ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ”ë° ì–´ë ¤ìš´ ê²½ìš° ë§Œë“œëŠ” ê°€ì§œ ê°ì²´ì´ë‹¤.

   [ì‚¬ìš©ë²•]

   - mockê°ì²´ë¥¼ ë§Œë“ ë‹¤. 
     - mock() í•¨ìˆ˜ ì´ìš©
     - @Mockì´ìš©
   - when(A).thenReturn(B); 

   [ì˜ˆì‹œ]

   ```java
   @Mock
   BookRepository bookRepository; // calë©”ì†Œë“œ : 10ì„ ë°˜í™˜í•˜ëŠ” ë©”ì†Œë“œ
   
   @Test
   public void calTest(){
     when(bookRepository.cal()).thenReturn(10);
   }
   ```

   


